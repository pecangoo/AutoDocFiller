<!DOCTYPE html>
<html>
<head>
    <title>Загрузка файла</title>
</head>
<body>
<div class="header">
	<h2>Заполнение шаблона</h2>
</div>
<form id="form_data" action="/index" method="post" enctype="multipart/form-data">

    <style>
		html {
			--main-color: #234988;
			--hover-color: #3e69ae;
		}

		body {
			margin: 0;
		}

		.header {
			width: 100%;
			position: fixed;
			background-color: var(--main-color);
			color: #ffffff;
			padding-left: 20px;
			top: 0;
		}

		.buttons {
			border-radius: 10px;
			margin-bottom: 20px;
			background-color: var(--main-color);
			cursor: pointer;
			color: #ffffff;
			border-color: var(--main-color);
			height: 40px;
			line-height: 20px;
			font-size: 16px;
			margin-left: 30px;
			box-shadow: 0px 3px 7px 0px #8c8c8c;
			border-width: 0;
			padding: 10px;
		}

		.container {
			width: calc(25px + 50%);
			display: flex;
			justify-content: center;
		}

		.header-mini {
			margin-left: 20px;
			color: var(--main-color);
		}

		.file-button {
			margin-left: 20px;
		}

		.buttons:hover {
			background-color: var(--hover-color);
		}

		.input-text {
			width: 40%;
			padding: 10px;
			box-sizing: border-box;
			height: 40px;
			border-color: transparent;
			/* border: 2px	var(--main-color) solid; */
			border-radius: 8px;
			font-size: 16px;
			box-shadow: 0px 3px 5px 1px #8c8c8c4a;
		}

        .one-line {
            display: flex;

            label {
                width: 20%;
                display: block;
                margin-bottom: 1px;
				font-size: 18px;
				margin-right: 15px;
				margin-left: 10px;
				text-align: end;
				line-height: 30px;
            }

            input {
                width: 30%;
                padding: 5px;
                box-sizing: border-box;
				margin-bottom: 20px;
				height: 30px;
				border-color: transparent;
				border: 2px	var(--main-color) solid;
				border-radius: 8px;
				box-shadow: 0px 3px 5px 1px #8c8c8c4a;
				
            }
        }

        .one-line2 {
			width: calc(25px + 50%);
			display: flex;
			justify-content: center;

            /* label {
                width: 10%;
                display: block;
                margin-bottom: 1px;
				/* font-size: 18px;
				margin-right: 15px;
				text-align: end;
				line-height: 30px; 
            } */

            /* input {
                width: 20%;
                padding: 1px;
                margin-bottom: 1px;
                box-sizing: border-box;
            } */ 
		}

		ul {
			margin-top: 90px;
		}
    </style>
    <ul>
        {% for item in data %}
            <div class="one-line">
                <label>{{ item["name_field"] }}</label>
                <input id="form1"
                       value="{{ item["value_field"] }}"
                       type="{{ item["type_field"] }}"
                       name="{{ item["tag_field"] }}"
                       title="{{ item["hint"] }}"
               >
            </div>
        {% endfor %}
    </ul>

    <input class="file-button"
		   id="form1"
           type="file"
           name="file"><br>    <br>
	<!-- <label class="input-file">
			<input type="file" name="file" id="form1" onchange="(e) => updateNamesFile(e)">
			<span class="input-file-btn">Выберите файл</span>           
			<span class="input-file-text" id="fileNameText"></span>
	</label><br>    <br> -->

   <div class="container">
		<input class="buttons"
				type="button"
				value="Заполнить документ"
				onclick="checkAllFields();">
   </div> 
    <br><br><br>
    <h3 class="header-mini">Сохранение шаблона</h3>
    {#            <input class="buttons" type="button" onclick="checkAllFields();">#}
    <div class="one-line2">
        <input class="input-text" type="text" placeholder="Введите имя шаблона" name="name_template" id="name_template">
        <input class="buttons" type="button" value="Сохранить шаблон" onclick="checkTemplate();">
    </div>


</form>
<br><br>
<h3 class="header-mini">Выбрать шаблон из существующих</h3>
<form id="form_data"
      action="/choose_template"
      method="get">
    <input class="buttons"
		   type="submit"
           value="Загрузить шаблон из списка">
</form>
<script>

    var message = "{{ message }}";
    if (message) {
        alert(message);
    }


    function checkAllFields() {
        var fields = document.querySelectorAll('[id = "form1"]')
        var isEmpty = false;
        fields.forEach(function (field) {
            if (field.value === "") {
                isEmpty = true
            }
        });
        if (isEmpty) {
            alert("Некоторые поля не заполнены")
        } else {
            var form = document.getElementById("form_data");
            form.submit();
        }

    }

    function checkTemplate() {
        console.log("85858");
        var textField = document.getElementById("name_template");
        var textValue = textField.value.trim();
        if (textValue === "") {
            alert("Введите название шаблона");
        } else {
            var form = document.getElementById("form_data");
            form.action = "/accept";
            form.submit();
        }
    }
	// function updateNamesFile(e) {
	// 	let file = e.files[0]
	// 	document.getElementById('fileNameText').innerHTML = file.name;
	// }
</script>

{#<script src="script.js"></script>#}
</body>
</html>
